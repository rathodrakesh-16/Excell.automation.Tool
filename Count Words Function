Sub CountWordsInColumnB()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim cell As Range
    Dim wordCount As Long
    Dim i As Long
    
    ' Set reference to the "Tools" sheet
    Set ws = ThisWorkbook.Sheets("Tools")
    
    ' Find the last row with data in column B
    lastRow = ws.Cells(ws.Rows.Count, "B").End(xlUp).Row
    
    ' Loop through each cell in column B, starting from row 2 (ignore row 1)
    For i = 2 To lastRow
        ' Get the cell in column B
        Set cell = ws.Cells(i, "B")
        
        ' Count the words in the cell
        wordCount = CountWords(cell.Value)
        
        ' Display the word count in column D
        ws.Cells(i, "D").Value = wordCount
        
        ' If the word count is less than 20, fill the cell with light red color
        If wordCount < 20 Then
            ws.Cells(i, "D").Interior.Color = RGB(255, 199, 206) ' Light Red
        Else
            ws.Cells(i, "D").Interior.ColorIndex = -4142 ' No fill (default)
        End If
    Next i
End Sub

' Function to count the number of words in a string
Function CountWords(text As String) As Long
    Dim words() As String
    Dim wordCount As Long
    
    ' Split the text into words based on spaces
    words = Split(Application.Trim(text), " ")
    
    ' If the cell is not empty, return the word count
    If Len(text) > 0 Then
        wordCount = UBound(words) + 1
    Else
        wordCount = 0
    End If
    
    ' Return the word count
    CountWords = wordCount
End Function
